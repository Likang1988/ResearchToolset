# 科研项目经费管理系统 (Research Project Funds Management System)

## 系统预览
![主界面](resources/screenshots/main_window.png)
![预算管理](resources/screenshots/budget_management.png)
![支出管理](resources/screenshots/expense_management.png)

## 项目简介
这是一个基于PySide6开发的科研项目经费管理系统，专门用于管理科研项目的预算和资金使用情况。系统提供以下核心功能：
- 多层级预算管理（总预算、年度预算、分类预算）
- 详细的支出记录与分类统计
- 预算执行情况实时监控
- 数据可视化与报表生成
- 数据导入导出功能

系统采用模块化设计，支持多用户权限管理，帮助科研团队高效管理项目经费。

## 功能特性

### 登录管理
- 创建用户
- 用户登录
- 密码提示

### 项目管理
- 项目创建与编辑
- 项目信息管理
- 项目状态跟踪

### 预算管理
- 多层级预算设置
- 预算执行情况监控
- 预算调整与审批

### 支出管理
- 支出记录与分类
- 支出审批流程
- 支出统计分析

### 报表功能
- 预算执行报表
- 支出明细报表
- 项目经费总览

## 使用示例

### 创建新项目
1. 点击"添加项目"按钮
2. 填写项目信息
3. 设置项目预算
4. 保存项目信息

### 记录支出
1. 选择目标项目
2. 点击"添加支出"
3. 填写支出详情
4. 提交审批

## 详细使用说明

### 1. 项目管理
#### 1.1 添加新项目
1. 在主界面点击"添加项目"按钮
2. 填写项目基本信息：
   - 财务编号：项目的财务系统编号
   - 项目名称：完整的项目名称
   - 项目编号：项目的标识编号
   - 项目类别：选择合适的项目类别
   - 起止日期：项目的开始和结束日期
   - 总经费：项目的总经费（单位：万元）
3. 点击"确定"保存项目信息

#### 1.2 编辑项目
1. 在项目列表中选择要编辑的项目
2. 点击"编辑项目"按钮
3. 修改需要更新的信息
4. 点击"确定"保存修改

#### 1.3 删除项目
1. 选择要删除的项目
2. 点击"删除项目"按钮
3. 确认删除操作

### 2. 预算管理
#### 2.1 设置项目预算
1. 在项目列表中点击"预算管理"按钮
2. 点击"添加预算"创建新预算
3. 选择预算类别：
   - 设备费
   - 材料费
   - 测试化验加工费
   - 燃料动力费
   - 差旅费
   - 会议费
   - 国际合作交流费
   - 出版/文献/信息传播/知识产权事务费
   - 劳务费
   - 专家咨询费
   - 其他支出
4. 输入预算金额
5. 点击"确定"保存预算

#### 2.2 预算调整
1. 选择需要调整的预算项
2. 点击"编辑"按钮
3. 修改预算金额
4. 填写调整原因
5. 保存修改

### 3. 支出管理
#### 3.1 记录新支出
1. 在预算管理界面点击"支出管理"
2. 点击"添加支出"按钮
3. 填写支出信息：
   - 支出日期
   - 支出类别
   - 金额
   - 用途说明
   - 供应商信息（如有）
   - 发票信息（如有）
4. 点击"保存"提交支出记录

#### 3.2 批量导入支出
1. 准备Excel格式的支出数据（按模板格式）
2. 点击"批量导入"按钮
3. 选择数据文件
4. 确认导入数据的正确性
5. 点击"确认导入"

### 4. 数据统计与分析
#### 4.1 查看预算执行情况
1. 在预算管理界面可直接查看：
   - 各类别预算使用比例
   - 剩余预算金额
   - 预警信息（超预算提醒）

#### 4.2 导出报表
1. 点击"导出报表"按钮
2. 选择要导出的报表类型：
   - 预算执行情况表
   - 支出明细表
   - 项目经费总览表
3. 选择导出格式（Excel/PDF）
4. 选择保存位置

### 5. 使用技巧
- 使用快捷键提高操作效率
- 定期备份数据库
- 及时记录支出信息
- 检查预算执行进度
- 注意预算调整审批流程

### 6. 注意事项
- 所有金额单位统一为"万元"
- 定期检查预算执行情况
- 重要操作前请二次确认
- 妥善保管项目相关文件
- 遵守经费使用规定

## Todo list：
1.界面美化（基于qfluentwidgets）
2.数据导入：支出信息批量导入、支出凭证导入（done）
3.数据导出
4.自定义的项目类别、开支内容、规格型号、供应商等信息自动保存，供后续下拉选择（done）
5.整合小工具：预算编制工具、间接经费计算器等



## 常见问题

### Q: 如何导入历史数据？
A: 系统支持Excel格式数据导入，请确保数据格式符合模板要求。

### Q: 预算可以调整吗？
A: 支持预算调整，但需要经过审批流程。

### Q: 系统支持多用户吗？
A: 支持多用户权限管理，不同角色具有不同操作权限。

## 技术架构
- **前端框架**：PySide6 (Qt for Python)
- **UI设计**：Qt Designer + QSS样式表
- **数据存储**：SQLite + SQLAlchemy ORM
- **数据分析**：Pandas + NumPy
- **可视化**：Matplotlib + Qt Charts
- **报表生成**：XlsxWriter
- **开发语言**：Python 3.8+
- **代码质量**：Pylint + Black
- **版本控制**：Git + GitHub Actions CI/CD

## 系统要求
- Python 3.8 或更高版本
- 操作系统：Windows/macOS/Linux

## 项目结构
```
FundsManagement/
├── docs/                    # 项目文档
├── resources/               # 资源文件
│   ├── icons/               # 图标资源
│   └── styles/              # 样式表
├── app/                     # 源代码
│   ├── controllers/         # 控制器
│   ├── models/              # 数据模型
│   │   └── database.py      # 数据库模型
│   ├── utils/               # 工具类
│   ├── components/          # 组件
│   │   ├── budget_dialog.py # 预算对话框
│   │   ├── budget_management.py # 预算管理
│   │   ├── expense_dialog.py    # 支出对话框
│   │   ├── expense_management.py # 支出管理
│   │   ├── main_window.py       # 主窗口
│   │   └── project_dialog.py    # 项目对话框
│   └── main.py              # 程序入口
├── tests/                   # 测试代码
├── requirements.txt         # 依赖包
└── README.md                # 项目说明
```

## 安装说明
1. 克隆项目仓库
```bash
git clone [repository-url]
cd FundsManagement
```

2. 创建并激活虚拟环境
```bash
python -m venv venv
source venv/bin/activate  # Unix/macOS
# 或
.\venv\Scripts\activate  # Windows
```

3. 安装依赖包
```bash
pip install -r requirements.txt
```

## 使用说明
1. 启动应用
```bash
python src/main.py
```

2. 登录系统
3. 开始使用各项功能：
   - 创建新项目
   - 设置项目预算
   - 记录支出信息
   - 查看统计报表

## 开发团队
- 项目经理：张三
- 前端开发：李四
- 后端开发：王五
- 测试工程师：赵六
- UI设计师：陈七

## 许可证
MIT License

## 联系方式
- 项目负责人：张三
- Email: funds_management@example.com
- GitHub: https://github.com/example/funds-management
- 项目文档：https://example.com/docs/funds-management
- 问题反馈：https://github.com/example/funds-management/issues
